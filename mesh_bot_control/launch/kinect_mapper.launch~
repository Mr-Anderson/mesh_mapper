<launch>

    <!-- Define arguments and defaults  -->
    <arg name="usb" default="0" />
    <arg name="display" default="0" />
    <arg name="robot" default="1" />
    <arg name="kinect" default="0" />
    <arg name="joint_gui" default="1" />
    <arg name="rviz" default="1" />
    <arg name="config" default="1" />
    
    <!-- launch kinect drivers    -->
    <group if="$(arg kinect)">
    
        <include file="$(find openni_launch)/launch/openni.launch" />
        
        <param name="/camera/driver/depth_registration" type="bool" value="true" />
        
        <node pkg="kinect_aux" type="kinect_aux_node" name="kinect_aux_node" />
        
    </group>
    
    
    
    
    <!-- launch control node    -->
    <node pkg="mesh_bot_control" type="control" name="control"  required="true" >
        
        <!-- rosparam file="$(find mesh_bot_control)/yaml/Control.yaml" command="load" / -->
        
        <!-- param name = "minus_sound" value = "$(find mesh_bot_control)/sounds/Ahooga_Car_Horn.wav" / -->
        
    </node>
    
    <!-- creat robot descrition and decide if gui wil launch -->
    <param name="robot_description" command="$(find xacro)/xacro.py '$(find mesh_bot_description)/urdf/mesh_bot.urdf.xacro'" />
    <param name="use_gui" value="$(arg joint_gui)"/>
    
    
    <!-- lauch the joint state publisher and robot state publisher -->
    <node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher" ></node>
    <node name="robot_state_publisher" pkg="robot_state_publisher" type="state_publisher" />
    <node name="rviz" pkg="rviz" type="rviz" args="-d $(find mesh_bot_control)/vcg/mesh_bot.vcg" if="$(arg rviz)"/>
    
    <!-- launch wiimote node -->
    <node pkg="wiimote" type="wiimote_node.py" name="wiimote" respawn="true" />
    
    <!-- launch soud play for speach syth -->
    <node pkg="sound_play" type="soundplay_node.py" name="sound_play" />
    
    <!-- run motor drivers    -->
    <node pkg="hardware_interface" type="hardware_interface" name="hardware_interface" args="twist:=cmd_vel" />
    
    <!-- launch the dynamic reconfigure gui  -->
    <node pkg="dynamic_reconfigure" type="reconfigure_gui" name="reconfigure_gui" if="$(arg config)" />
    
    
    <!-- launch debugging displays -->
    <group if="$(arg display)" >
        
        <node pkg="image_view" type="disparity_view" name="disparity_image" args="image:=/camera/depth_registered/disparity" />
        
        <node pkg="image_view" type="image_view" name="depth_image" args="image:=/camera/depth_registered/image_rect" />
        
        <node pkg="image_view" type="image_view" name="y_sobel_image" args="image:=/pre_vis_proc/y_sobel" />
        
        <node pkg="image_view" type="image_view" name="color_image" args="image:=/camera/rgb/image_rect_color" />
        
        <node pkg="dynamic_reconfigure" type="reconfigure_gui" name="reconfigure_gui" />

    </group>
    
</launch>
